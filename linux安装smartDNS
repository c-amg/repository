## 什么是smartDNS?
SmartDNS是一个运行在本地的DNS服务器，SmartDNS接受本地客户端的DNS查询请求，从多个上游DNS服务器获取DNS查询结果，并将访问速度最快的结果返回给客户端，提高网络访问速度。 同时支持指定特定域名IP地址，并高性匹配，达到过滤广告的效果。

## 原理
![architecture](https://raw.githubusercontent.com/c-amg/image-hexo/master/images/architecture.6dcinikzwfo0.png)
1.SmartDNS接收本地网络设备的DNS查询请求，如PC，手机的查询请求。
2.SmartDNS将查询请求发送到多个上游DNS服务器，可采用标准UDP查询，非标准端口UDP查询，及TCP查询。
3.上游DNS服务器返回域名对应的Server IP地址列表。SmartDNS检测与本地网络访问速度最快的Server IP。
4.将访问速度最快的Server IP返回给本地客户端。

## 特性
### 1.多DNS上游服务器
支持配置多个上游DNS服务器，并同时进行查询，即使其中有DNS服务器异常，也不会影响查询。

### 2.返回最快IP地址
支持从域名所属IP地址列表中查找到访问速度最快的IP地址，并返回给客户端，提高网络访问速度。

### 3.支持多种查询协议
支持UDP，TCP，TLS, HTTPS查询，以及非53端口查询。

### 4.特定域名IP地址指定
支持指定域名的IP地址，达到广告过滤效果，避免恶意网站的效果。

### 5.域名高性能后缀匹配
支持域名后缀匹配模式，简化过滤配置，过滤20万条记录时间<1ms

### 6.域名分流
支持域名分流，不同类型的域名到不同的DNS服务器查询。

### 7.Linux/Windows多平台支持
支持标准Linux系统（树莓派），openwrt系统各种固件，华硕路由器原生固件。以及支持Windows 10 WSL (Windows Subsystem for Linux)。

### 8.支持IPV4, IPV6双栈
支持IPV4，IPV6网络，支持查询A, AAAA记录，支持双栈IP速度优化，并支持完全禁用IPV6 AAAA解析。

### 9.高性能，占用资源少
多线程异步IO模式，cache缓存查询结果。
# 一、基于linxu系统安装smartDNS

## 1、使用wget命令下载安装包
```bash
wget https://github.com/pymumu/smartdns/releases/download/Release33/smartdns.1.2020.09.08-2235.x86_64-linux-all.tar.gz
```
## 2、解压文件
```bash
tar -zxvf smartdns.1.2020.09.08-2235.x86_64-linux-all.tar.gz
```
## 3、切换目录
```bash
cd smartdns/
```
## 4、修改权限
```bash
chmod +x ./install
```
## 5、安装smartDNS
```bash
./install -i
```
# 二、修改配置文件
```bash
vi /etc/smartdns/smartdns.conf
只需要增加server [IP]:port, server-tcp [IP]:port配置项
```
# 三、开机启动smartDNS
```bash
systemctl enable smartdns
systemctl start smartdns
```
# 四、将DNS请求转发的SmartDNS解析
修改本地路由器的DNS服务器，将DNS服务器配置为SmartDNS。

# 五、检测服务是否配置成功
使用nslookup -querytype=ptr smartdns查询域名


